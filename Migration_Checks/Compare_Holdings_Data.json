[
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Local_End_Date",
        "expression": "grel:if(isNull(value),\"Present\",value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Change null values in column ``Local_End_Date``  to `Present`"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Default_End_Date",
        "expression": "grel:if(isNull(value),\"Present\",value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Change null values in column ``Default_End_Date``  to `Present`"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Local_Start_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[1].length()==1,value.split(\"-\")[0]+\"-0\"+value.split(\"-\")[1]+\"-\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad months in column ``Local_Start_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Local_Start_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[2].length()==1,value.substring(0,value.lastIndexOf(\"-\"))+\"-0\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad days in column ``Local_Start_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Local_End_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[1].length()==1,value.split(\"-\")[0]+\"-0\"+value.split(\"-\")[1]+\"-\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad months in column ``Local_End_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Local_End_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[2].length()==1,value.substring(0,value.lastIndexOf(\"-\"))+\"-0\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad days in column ``Local_End_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Default_Start_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[1].length()==1,value.split(\"-\")[0]+\"-0\"+value.split(\"-\")[1]+\"-\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad months in column ``Default_Start_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Default_Start_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[2].length()==1,value.substring(0,value.lastIndexOf(\"-\"))+\"-0\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad days in column ``Default_Start_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Default_End_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[1].length()==1,value.split(\"-\")[0]+\"-0\"+value.split(\"-\")[1]+\"-\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad months in column ``Default_End_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Default_End_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[2].length()==1,value.substring(0,value.lastIndexOf(\"-\"))+\"-0\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad days in column ``Default_End_Date``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "baseColumnName": "HM_Local_Start_Date",
        "expression": "grel:if(isNull(value),cells.HM_Default_Start_Date.value,value)",
        "onError": "set-to-blank",
        "newColumnName": "EBSCO_Holdings_Start_Date",
        "columnInsertIndex": 7,
        "description": "Create column ``EBSCO_Holdings_Start_Date`` with the EBSCO custom/local holdings start date if there is one or the default holdings start date if there isn't"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "baseColumnName": "Selected_Coverage_Statement",
        "expression": "grel:if(or(value==\"Global and local\",value==\"Global or local\"),cells.Default_Start_Date.value+\"|\"+cells.Local_Start_Date.value,if(value==\"Only local\",cells.Local_Start_Date.value,cells.Default_Start_Date.value))",
        "onError": "set-to-blank",
        "newColumnName": "Alma_Holdings_Start_Date",
        "columnInsertIndex": 8,
        "description": "Create column ``Alma_Holdings_Start_Date`` with the Alma custom/local and/or default/global holdings start date based on the ``Selected_Coverage_Statement`` value for the row, separating the dates with a pipe if both are in the cell"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "baseColumnName": "HM_Local_End_Date",
        "expression": "grel:if(isNull(value),cells.HM_Default_End_Date.value,value)",
        "onError": "set-to-blank",
        "newColumnName": "EBSCO_Holdings_End_Date",
        "columnInsertIndex": 9,
        "description": "Create column ``EBSCO_Holdings_End_Date`` with the EBSCO custom/local holdings start date if there is one or the default/global holdings start date if there isn't"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "baseColumnName": "Selected_Coverage_Statement",
        "expression": "grel:if(or(value==\"Global and local\",value==\"Global or local\"),cells.Default_End_Date.value+\"|\"+cells.Local_End_Date.value,if(value==\"Only local\",cells.Local_End_Date.value,cells.Default_End_Date.value))",
        "onError": "set-to-blank",
        "newColumnName": "Alma_Holdings_End_Date",
        "columnInsertIndex": 10,
        "description": "Create column ``Alma_Holdings_Start_Date`` with the Alma custom/local and/or default/global holdings end date based on the ``Selected_Coverage_Statement`` value for the row, separating the dates with a pipe if both are in the cell"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Holdings_Start_Date",
        "expression": "grel:if(value.endsWith(\"*\"),value.substring(0,-1)+\"|Other holdings range(s) not exported\",value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "For ``Alma_Holdings_Start_Date`` values ending with an asterisk, replace it with a pipe and the message `Other holdings range(s) not exported`"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Holdings_End_Date",
        "expression": "grel:if(value.endsWith(\"*\"),value.substring(0,-1)+\"|Other holdings range(s) not exported\",value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "For ``Alma_Holdings_End_Date`` values ending with an asterisk, replace it with a pipe and the message `Other holdings range(s) not exported`"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "baseColumnName": "EBSCO_Holdings_Start_Date",
        "expression": "grel:if(and(value==cells.Alma_Holdings_Start_Date.value,cells.EBSCO_Holdings_End_Date.value==cells.Alma_Holdings_End_Date.value),forEachIndex(value.split(\"|\"),i,start,start+\" to \"+cells.Alma_Holdings_End_Date.value.split(\"|\")[i]).join(\"|\"),if(or(value==cells.Alma_Holdings_Start_Date.value,cells.EBSCO_Holdings_End_Date.value==cells.Alma_Holdings_End_Date.value),if(value==cells.Alma_Holdings_Start_Date.value,\"Start date match\",\"End date match\"),\"No match\"))",
        "onError": "set-to-blank",
        "newColumnName": "Holdings_Dates",
        "columnInsertIndex": 7,
        "description": "Create column ``Holdings_Dates`` with the start and end holdings dates separated by `to` if both the beginning and ending holdings dates match ( with multiple ranges separated by pipes), `Start date match` or `End date match` if only one sets of dates match, and `No match` if neither set of dates match"
    }
]