[
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Default_End_Date",
        "expression": "grel:if(isNull(value),\"Present\",value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Change null values in column ``Alma_Default_End_Date``  to `Present`"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Local_End_Date",
        "expression": "grel:if(isNull(value),\"Present\",value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Change null values in column ``Alma_Local_End_Date``  to `Present`"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Default_Start_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[1].length()==1,value.split(\"-\")[0]+\"-0\"+value.split(\"-\")[1]+\"-\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad months in column ``Alma_Default_Start_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Default_Start_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[2].length()==1,value.substring(0,value.lastIndexOf(\"-\"))+\"-0\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad days in column ``Alma_Default_Start_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Default_End_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[1].length()==1,value.split(\"-\")[0]+\"-0\"+value.split(\"-\")[1]+\"-\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad months in column ``Alma_Default_End_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Default_End_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[2].length()==1,value.substring(0,value.lastIndexOf(\"-\"))+\"-0\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad days in column ``Alma_Default_End_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Local_Start_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[1].length()==1,value.split(\"-\")[0]+\"-0\"+value.split(\"-\")[1]+\"-\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad months in column ``Alma_Local_Start_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Local_Start_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[2].length()==1,value.substring(0,value.lastIndexOf(\"-\"))+\"-0\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad days in column ``Alma_Local_Start_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Local_End_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[1].length()==1,value.split(\"-\")[0]+\"-0\"+value.split(\"-\")[1]+\"-\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad months in column ``Alma_Local_End_Date``"
    },
    {
        "op": "core/text-transform",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "columnName": "Alma_Local_End_Date",
        "expression": "grel:if(value.contains(\"-\"),if(value.split(\"-\")[2].length()==1,value.substring(0,value.lastIndexOf(\"-\"))+\"-0\"+value.split(\"-\")[2],value),value)",
        "onError": "keep-original",
        "repeat": false,
        "repeatCount": 10,
        "description": "Zero pad days in column ``Alma_Local_End_Date``"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "baseColumnName": "Local_Start_Date",
        "expression": "grel:if(isNull(value),cells.Default_Start_Date.value,value)",
        "onError": "set-to-blank",
        "newColumnName": "EBSCO_Holdings_Start_Date",
        "columnInsertIndex": 13,
        "description": "Create column ``EBSCO_Holdings_Start_Date`` with the EBSCO custom holdings start date if set or the default holdings start date if not"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "baseColumnName": "Alma_Dates_Source",
        "expression": "grel:if(or(value==\"Global and local\",value==\"Global or local\"),cells.Alma_Default_Start_Date.value+\"|\"+cells.Alma_Local_Start_Date.value,if(value==\"Only local\",cells.Alma_Local_Start_Date.value,cells.Alma_Default_Start_Date.value))",
        "onError": "set-to-blank",
        "newColumnName": "Alma_Holdings_Start_Date",
        "columnInsertIndex": 14,
        "description": "Create column ``Alma_Holdings_Start_Date`` with the Alma custom and/or default holdings start date based on the ``Alma_Dates_Source`` value for the row, separating the dates with a pipe if both are in the cell"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "baseColumnName": "Local_End_Date",
        "expression": "grel:if(isNull(value),cells.Default_End_Date.value,value)",
        "onError": "set-to-blank",
        "newColumnName": "EBSCO_Holdings_End_Date",
        "columnInsertIndex": 15,
        "description": "Create column ``EBSCO_Holdings_End_Date`` with the EBSCO custom holdings start date if set or the default holdings start date if not"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "baseColumnName": "Alma_Dates_Source",
        "expression": "grel:if(or(value==\"Global and local\",value==\"Global or local\"),cells.Alma_Default_End_Date.value+\"|\"+cells.Alma_Local_End_Date.value,if(value==\"Only local\",cells.Alma_Local_End_Date.value,cells.Alma_Default_End_Date.value))",
        "onError": "set-to-blank",
        "newColumnName": "Alma_Holdings_End_Date",
        "columnInsertIndex": 16,
        "description": "Create column ``Alma_Holdings_Start_Date`` with the Alma custom and/or default holdings end date based on the ``Alma_Dates_Source`` value for the row, separating the dates with a pipe if both are in the cell"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [],
            "mode": "record-based"
        },
        "baseColumnName": "EBSCO_Holdings_Start_Date",
        "expression": "grel:if(and(value==cells.Alma_Holdings_Start_Date.value,cells.EBSCO_Holdings_End_Date.value==cells.Alma_Holdings_End_Date.value),\"Match\",if(or(value==cells.Alma_Holdings_Start_Date.value,cells.EBSCO_Holdings_End_Date.value==cells.Alma_Holdings_End_Date.value),if(value==cells.Alma_Holdings_Start_Date.value,\"Holdings start match\",\"Holdings end match\"),null))",
        "onError": "set-to-blank",
        "newColumnName": "Holdings_Dates",
        "columnInsertIndex": 13,
        "description": "Create column ``Holdings_Dates`` with values `Match` if both the beginning and ending holdings dates match, `Holdings start match` or `Holdings end match` if only one sets of dates match, and a null cell if neither set of dates match"
    },
    {
        "op": "core/column-addition",
        "engineConfig": {
            "facets": [
                {
                    "type": "list",
                    "name": "Holdings_Dates",
                    "expression": "value",
                    "columnName": "Holdings_Dates",
                    "invert": true,
                    "omitBlank": false,
                    "omitError": false,
                    "selection": [
                        {
                            "v": {
                                "v": "Match",
                                "l": "Match"
                            }
                        }
                    ],
                    "selectBlank": false,
                    "selectError": false
                }
            ],
            "mode": "record-based"
        },
        "baseColumnName": "EBSCO_Holdings_Start_Date",
        "expression": "grel:value+\" to \"+cells.EBSCO_Holdings_End_Date.value",
        "onError": "set-to-blank",
        "newColumnName": "Change_Alma_Holdings_Date_to",
        "columnInsertIndex": 2,
        "description": "Create column ``Change_Alma_Holdings_Date_to`` with the HM holdings dates if those same dates aren't accurately reflected in Alma"
    }
]